# Feature 0005: Search Result Pagination

## Description
Implement pagination functionality for the search results with a limit of 10 items per page to optimize search result display and performance. This will replace the current approach of showing up to 100 results at once with a paginated interface that allows users to navigate through results efficiently.

## Files to Modify

### lib/types.ts
- **Add pagination interfaces**:
  - `PaginationInfo` interface with `currentPage`, `totalPages`, `totalCount`, `pageSize`, `hasNextPage`, `hasPreviousPage`
  - Modify `SearchResponse` interface to include `pagination: PaginationInfo`
  - Add `page?: number` to `SearchFilters` interface

### app/api/search/route.ts
- **Update search endpoint to support pagination**:
  - Parse `page` query parameter (defaults to 1)
  - Set fixed `pageSize = 10` 
  - Calculate `offset = (page - 1) * pageSize`
  - Modify response to include pagination metadata
  - Update both GET and POST methods
  - **Algorithm**:
    1. Extract page number from query parameters
    2. Calculate offset and limit for current page
    3. Pass pagination parameters to search function
    4. Count total matching results for pagination metadata
    5. Return paginated results with pagination info

### lib/search.ts
- **Modify `searchInspections` function signature**:
  - Change to `searchInspections(filters: SearchFilters, page: number = 1, pageSize: number = 10): Promise<{ results: SewerInspection[], totalCount: number }>`
  - **Algorithm**:
    1. Calculate offset: `(page - 1) * pageSize`
    2. Search through files and collect all matching results
    3. Count total matches for pagination metadata
    4. Return slice of results for current page: `results.slice(offset, offset + pageSize)`
    5. Return both paginated results and total count

### components/SearchResults.tsx
- **Add pagination component**:
  - Create `Pagination` component with Previous/Next buttons and page numbers
  - Add pagination controls below the results table/cards
  - Show current page, total pages, and result count information
  - Handle page navigation via callback to parent component
  - **Props**: `currentPage`, `totalPages`, `onPageChange`, `totalCount`

### app/search/page.tsx
- **Update search page state management**:
  - Add `currentPage` state (defaults to 1)
  - Add `totalPages` and `totalCount` state
  - Modify `handleSearch` to include page parameter and reset to page 1 on new search
  - Add `handlePageChange` function to update current page and fetch new results
  - Update `SearchResults` component props to include pagination data
  - **Algorithm**:
    1. On new search: reset currentPage to 1, call search API
    2. On page change: update currentPage, call search API with same filters but new page
    3. Update state with paginated results and pagination metadata

### components/SearchForm.tsx
- **Remove limit input field**:
  - Remove the limit filter from search form since pagination will handle result limiting
  - Update form validation to remove limit-related logic

## Implementation Algorithm

### Search Flow with Pagination:
1. User submits search form → page resets to 1
2. API receives search request with page parameter
3. Search function processes all files to count total matches
4. Return slice of results for requested page (10 items)
5. Frontend displays results with pagination controls
6. User clicks page navigation → new API call with same filters, different page

### Pagination Logic:
- Page size fixed at 10 items
- Page numbers start from 1
- Calculate total pages: `Math.ceil(totalCount / pageSize)`
- Offset calculation: `(page - 1) * pageSize`
- Show pagination only when totalCount > pageSize

## Response Format Changes

### Updated SearchResponse:
```typescript
{
  results: SewerInspection[],
  pagination: {
    currentPage: number,
    totalPages: number,
    totalCount: number,
    pageSize: number,
    hasNextPage: boolean,
    hasPreviousPage: boolean
  },
  filters: SearchFilters
}
```
